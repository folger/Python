import os
import time
import requests
import bs4

fids = (
219,
221,
222,
223,
225,
226,
227,
228,
230,
231,
238,
239,
240,
263,
264,
268,
269,
280,
282,
284,
285,
286,
287,
288,
289,
294,
295,
296,
298,
300,
301,
302,
303,
304,
309,
310,
312,
315,
317,
318,
320,
321,
322,
323,
324,
325,
326,
327,
328,
329,
331,
332,
333,
334,
335,
336,
337,
338,
339,
340,
341,
344,
345,
346,
353,
354,
355,
356,
357,
358,
359,
360,
362,
363,
365,
366,
367,
368,
369,
370,
371,
372,
373,
374,
375,
377,
383,
386,
390,
391,
392,
393,
394,
395,
398,
399,
400,
402,
403,
404,
405,
406,
407,
408,
409,
412,
413,
414,
415,
416,
418,
420,
422,
423,
425,
430,
432,
434,
435,
436,
437,
438,
439,
440,
442,
443,
445,
446,
447,
449,
450,
451,
453,
454,
455,
456,
457,
461,
462,
463,
464,
465,
466,
468,
469,
470,
471,
472,
474,
475,
476,
482,
483,
487,
488,
489,
490,
494,
495,
496,
497,
500,
501,
502,
504,
505,
506,
507,
508,
509,
510,
512,
513,
521,
522,
523,
524,
525,
527,
530,
531,
535,
)

def get_page_source(fid):
    url = 'https://www.originlab.com/FileExchange/Details.aspx?fid={}'.format(fid)
    # r = requests.get(url, timeout=30)

    data = {}
    data['__EVENTTARGET'] = 'Header1$LanguageSwitch2'
    data['Header1$LanguageSwitch2'] = 'ja'

    r = requests.post(url, data, timeout=30)
    return r.text

with open('AppDesc.txt', 'w', encoding='utf-8') as f:
    for fid in fids:
        print(fid)
        s = 'ERROR'
        try:
            soup = bs4.BeautifulSoup(get_page_source(fid), 'html.parser')
            s = soup.find(id='ContentPlaceHolderBody_lblSummary').text
        except Exception:
            pass
        s = '{}\t{}'.format(fid, s)
        print(s, file=f, flush=True)
        time.sleep(0.5)
os.system('pause')
